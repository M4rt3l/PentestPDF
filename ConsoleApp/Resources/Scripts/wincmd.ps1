param (
    [string]$desktopPath = [System.Environment]::GetFolderPath('Desktop'),
    [string]$target = "127.0.0.1"
)

$outputsDirectory = "$desktopPath\Outputs"
$outputPath = "$outputsDirectory\wincmd.txt"

if (-not (Test-Path $outputsDirectory)) {
    New-Item -Path $outputsDirectory -ItemType Directory
}

"##################################### WINDOWS COMMANDS OUTPUT #####################################" > $outputPath

$commands = @(
    "whoami",
    "systeminfo",
    "ipconfig /all",
    "tracert $target",
    "nslookup $target"
    #"netstat -a"
)

foreach ($command in $commands) {
    "`n# Command: $command" | Out-File -FilePath $outputPath -Append
    Invoke-Expression $command | Out-File -FilePath $outputPath -Append
}